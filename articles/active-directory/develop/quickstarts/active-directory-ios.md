---
title: Azure AD v2 iOS Quickstart | Microsoft Docs
description: Sign-in users and query Microsoft Graph in an iOS native application
services: active-directory
documentationcenter: dev-center-name
author: andretms
manager: mtillman
editor: ''

ms.assetid: 820acdb7-d316-4c3b-8de9-79df48ba3b06
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/09/2018
ms.author: andret
ms.custom: aaddev 

---

# Call the Microsoft Graph API from an iOS native app

This quickstart contains a code sample that demonstrates how a native iOS application can sign in personal, work and school accounts, get an access token, and call the Microsoft Graph API.

![How the sample app generated by this guide works](media/active-directory-ios/iosintro.png)

> [!div renderon="docs"]
> ## Step 1: Register your application
> 
> 1. To register an application, go to the [Azure AD - Application Registration](https://apps.dev.microsoft.com/portal/register-app)
> 1. Enter a name for your application and click **Create**
> 1. Follow the instructions to configure your application and add **msal{AppId}://auth** in the list of redirect URLs.

> [!div renderon="portal" class="sxs-lookup"]
> ## Step 1: Configure your application
> For the code sample for this quickstart to work, you need to add a reply URL as **msal{AppId}://auth** (where l{AppId} is this application Id).
> > [!div renderon="portal" id="makechanges" class="nextstepaction"]
> > [Make this change for me]()

## Step 2: Download your web server or project

- [Download the XCode Project](https://github.com/Azure-Samples/active-directory-ios-swift-native-v2/archive/master.zip)

## Step 3: Configure your project

1. Extract the zip file and open the project in XCode
1. Edit **ViewController.swift** and replace replace the line starting with 'let kClientID' with:

    ```csharp
    private static string ClientId = "Enter_the_Application_Id_here";
    ```
1. Control+click **Info.plist** to bring up the contextual menu, and then click: **Open As** > **Source Code**
1. Under the dict root node, add the following:

    ```xml
    <key>CFBundleURLTypes</key>
    <array>
        <dict>
            <key>CFBundleTypeRole</key>
            <string>Editor</string>
            <key>CFBundleURLName</key>
            <string>$(PRODUCT_BUNDLE_IDENTIFIER)</string>
            <key>CFBundleURLSchemes</key>
            <array>
                <string>msal[Your_Application_Id_Here]</string>
                <string>auth</string>
            </array>
        </dict>
    </array>
    ```

## More Information

Below an overview of this Quickstart:

### MSAL

MSAL ([MSAL.framework](https://github.com/AzureAD/microsoft-authentication-library-for-objc)) is the library used to sign in users and request tokens used to access an API protected by Microsoft Azure Active Directory. You can use carthage to install it by first running the following command in bash terminal from App’s root folder to build MSAL:

```bash
echo "github \"AzureAD/microsoft-authentication-library-for-objc\" \"master\"" > Cartfile
carthage update
```

Then, in XCode, open the **General**, go to **Linked Frameworks and Libraries** and add **MSAL.framework** in **Add other...**, then add the following content in **New Run Script Phase**:

```text
/usr/local/bin/carthage copy-frameworks
```

And the following to **Input Files**:

```text
$(SRCROOT)/Carthage/Build/iOS/MSAL.framework
```

### MSAL Initialization

You can add the reference for MSAL by adding the line below:

```swift
import MSAL
```

Then initialize MSAL using the line below:

```swift
self.applicationContext = try MSALPublicClientApplication.init(clientId: kClientID, authority: kAuthority)
```

> |Where: ||
> |---------|---------|
> |clientId | The Application Id from the application registered in *portal.microsoft.com* |
> |authority | The Azure AD v2 endpoint - in most of cases this will be *https<span/>://login.microsoftonline.com/common/v2.0*|

### Requesting tokens

Msal has two methods used acquire tokens - `acquireToken` and `acquireTokenSilent`:

#### Getting a user token interactively

 Some situations require forcing users interact with Azure Active Directory v2 endpoint which will result a context switch to the system browser, to either validate users's credentials or for consent – some examples include:

- The first time users signs-in to the application
- Users may need to reenter their credentials because the password has expired
- Your application is requesting access to a resource that the user needs to consent to
- Two factor authentication is required

```swift
self.applicationContext.acquireToken(forScopes: self.kScopes)
```

> |Where:||
> |---------|---------|
> |forScopes | Contains the scopes being requested (i.e. `{ "user.read" }` for Microsoft Graph or `{ "api://<Application ID>/access_as_user" }` for custom Web APIs) |

#### Getting a user token silently

You don't want to require user to validate their credentials every time they need to access a resource - most of the time you want token acquisitions and renewal without any user interaction - `AcquireTokenSilentAsync` is the method commonly used to obtain tokens used to access protected resources after the initial `AcquireTokenAsync`:

```swift
self.applicationContext.acquireTokenSilent(forScopes: self.kScopes, user: applicationContext.users().first)
```

> |Where: ||
> |---------|---------|
> |forScopes | Contains the scopes being requested (i.e. `{ "user.read" }` for Microsoft Graph or `{ "api://<Application ID>/access_as_user" }` for custom Web APIs) |
 |applicationContext.users().first | The first user in the cache (MSAL support multiple users in a single app) |

## What is next

Try out the iOS tutorial for a complete step-by-step guide on building applications and building new features, including a full explanation of this Quickstart:

### Learn the steps to create the application used in this Quickstart

> [!div class="nextstepaction"]
> [Call Graph API iOS tutorial](https://docs.microsoft.com/en-us/azure/active-directory/develop/guidedsetups/active-directory-ios)

[!INCLUDE [Help and support](../../../../includes/active-directory-develop-help-support-include.md)]