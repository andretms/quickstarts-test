---
title: Azure AD v2 JavaScript SPA quickstart | Microsoft Docs
description: Learn how JavaScript SPA applications can call an API that require access tokens by Azure Active Directory v2.0 endpoint
services: active-directory
documentationcenter: dev-center-name
author: andretms
manager: mtillman
editor: ''

ms.service: active-directory
ms.component: develop
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 07/10/2018
ms.author: andret
ms.custom: aaddev

#Customer intent: As an app developer, I want to learn how to get access tokens using the Azure AD v2.0 endpoint so that my JavaScript app can sign in personal and work and school accounts.
---

# Quickstart: Sign in users and acquire an access token from a JavaScript application

In this quickstart, you'll learn how to use a code sample that demonstrates how a JavaScript single page application (SPA) can sign in personal accounts, work and school accounts, get an access token, and call the Microsoft Graph API.

![How the sample app generated by this Quickstart works](media/active-directory-javascriptspa/javascriptspa-intro.png)

> [!div renderon="docs"]
> ## Register your application and download your quickstart app
> You have two options to start your quickstart application:
> * [Express] [Option 1: Register and auto configure your app and then download your code sample](#option-1-register-and-auto-configure-your-app-and-then-download-your-code-sample)
> * [Manual] [Option 2: Register and manually configure your application and code sample](#option-2-register-and-manually-configure-your-application-and-code-sample)
>
> ### Option 1: Register and auto configure your app and then download your code sample
>
> 1. Go to the [Azure portal - Application Registration [Prod]](https://portal.azure.com/?Microsoft_AAD_RegisteredApps=true#blade/Microsoft_AAD_RegisteredApps/applicationsListBlade/quickStartType/JavascriptSpaQuickstartPage/sourceType/docs).
> 1. Enter a name for your application and click **Register**.
> 1. Follow the instructions to download and automatically configure your new application for you in one click.
> [!div renderon="docs"]
> ### Option 2: Register and manually configure your application and code sample
> #### Step 1: Register your application
> 
> 1. To register an application, go to the [Azure portal - Application Registration](https://aka.ms/registeredappsprod) and select **New registration**.
> 1. Enter a name for your application, add `http://localhost:44316/` in **Reply URL**, and click **Register**.
> 1. Select **Authentication** menu, set **ID tokens** under **Implicit Grant**, and then select **Save**.

> [!div class="sxs-lookup" renderon="portal" class="alert alert-info"]
> #### Step 1: Configure your application in Azure portal
> For the code sample for this quickstart to work, you need to add a reply URL as `http://localhost:44316/` and enable **Implicit Grant**.
> > [!div renderon="portal" id="makechanges" class="nextstepaction"]
> > [Make these changes for me]()
>
> > [!div id="appconfigured"]
> > ![Already configured](media/active-directory-javascriptspa/green-check.png) Your application is configured with these attributes

#### Step 2: Download your web server or project

* [Download the Visual Studio project](https://github.com/Azure-Samples/active-directory-javascript-graphapi-v2/archive/VisualStudio.zip)
* [Download the core project files - for a web server, such as Node.js](https://github.com/Azure-Samples/active-directory-javascript-graphapi-v2/archive/core.zip)

#### Step 3: Configure your JavaScript SPA

> [!div renderon="docs"]
> Edit `msalconfig.js` and replace `Enter_the_Application_Id_here` with the Application ID your application:

> [!div class="sxs-lookup" renderon="portal"]
> Edit `msalconfig.js` and replace msalconfig with:

```javascript
var msalconfig = {
    clientID: "Enter_the_Application_Id_here",
    redirectUri: location.origin
};
```
> [!NOTE]
> If you use [Visual Studio 2017](https://visualstudio.microsoft.com/downloads/), the Redirect URL will be set to to *http:/<span/>/localhost:44316/* as it is configured in the code sample's project. If you use [Node.js](https://nodejs.org/en/download/) or any other web server, set the redirect URL to `http://localhost:44316/` and then configure the server to start listening this port. 
>
> For Node.js, you can run the following from the project's directory to start listening on port 44316:
> ```batch
> node server.js
> ```

## More Information

### *msal.js*

MSAL is the library used to sign in users and request tokens used to access an API protected by Microsoft Azure Active Directory (Azure AD). The quickstart's *index.html* contains a reference to the library:

```html
<script src="https://secure.aadcdn.microsoftonline-p.com/lib/0.1.1/js/msal.min.js"></script>
````

Alternatively, if you have Node installed, you can download it through npm:

```batch
npm install msal
```

### MSAL initialization

The quickstart code also shows how you how you initialize the library:

```javascript
var userAgentApplication = new Msal.UserAgentApplication(msalconfig.clientID, null, loginCallback, {
    redirectUri: msalconfig.redirectUri
});
```

> |Where  |  |
> |---------|---------|
> |`ClientId`     |Application Id from the application registered in the Azure Portal|
> |`authority`    |It is the authority URL. *null* sets the default authority to <i>https:<span/>//login.microsoftonline.com/common</i>|
> |`loginCallBack`| Name of a callback method called after the authentication|
> |`redirectUri`  |URL where users are sent after authentication against Azure AD v2 Endpoint|

### Sign in users

The following code snippet shows how you sign in users:

```javascript
userAgentApplication.loginRedirect(graphAPIScopes);
```

> |Where  |  |
> |---------|---------|
> | `graphAPIScopes`   | (Optional) Contains scopes being requested at login time (that is, `[ "user.read" ]` for Microsoft Graph or `[ "api://<Application ID>/access_as_user" ]` for custom Web APIs). |

> [!TIP]
> Alternatively, you may want to use the `loginPopup` method to display a popup window to sign in the user.

### Requesting tokens

MSAL has three methods used to acquire tokens: `acquireTokenRedirect`, `acquireTokenPopup` and `acquireTokenSilent`:

#### Getting a user token silently

The `acquireTokenSilent` method handles token acquisitions and renewal without any user interaction. After the `loginRedirect` or `loginPopup` method is executed for the first time, `acquireTokenSilent` is the method commonly used to obtain tokens that are used to access protected resources for subsequent calls - as calls to request or renew tokens are made silently.

```javascript
// Try to acquire the token used to query Graph API silently first:
userAgentApplication.acquireTokenSilent(graphAPIScopes)
```

> |Where  |  |
> |---------|---------|
> | `graphAPIScopes`   | (Optional) Contains scopes being requested at login time (that is, `[ "user.read" ]` for Microsoft Graph or `[ "api://<Application ID>/access_as_user" ]` for custom Web APIs). |

#### Getting a user token interactively

 There are situations where you need to force users to interact with Azure AD v2.0 endpoint. For example:
* Users may need to reenter their credentials because their password has expired
* Your application is requesting access to additional resource scopes that the user needs to consent to
* Two factor authentication is required

The usual recommended pattern for most applications is to call `acquireTokenSilent` first, then catch the exception and then call `acquireTokenRedirect` (or `acquireTokenPopup`) to start an interactive request.

Calling the `acquireTokenRedirect(scope)` result in redirecting users to the Azure AD v2.0 endpoint (or `acquireTokenPopup(scope)` result on a popup window) where users need to interact with by either confirming their credentials, giving the consent to the required resource, or completing the two factor authentication.

```javascript
userAgentApplication.acquireTokenRedirect(graphAPIScopes);
```

## Next steps

Try out the JavaScript tutorial for a complete step-by-step guide on how to build the application for this quickstart.

### Learn the steps to create the application for this quickstart

> [!div class="nextstepaction"]
> [Call Graph API tutorial](https://docs.microsoft.com/azure/active-directory/develop/guidedsetups/active-directory-javascriptspa)

### Browse the MSAL repo for documentation, FAQ, issues, and more

> [!div class="nextstepaction"]
> [msal.js GitHub repo](https://github.com/AzureAD/microsoft-authentication-library-for-js)


[!INCLUDE [Help and support](../../../../includes/active-directory-develop-help-support-include.md)]
